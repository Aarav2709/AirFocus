generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Session {
  id          String    @id @default(cuid())
  startAt     DateTime
  endAt       DateTime?
  targetMin   Int
  durationMin Int
  tag         Tag?      @relation(fields: [tagId], references: [id])
  tagId       String?
  notes       String?
  miles       Int
  aborted     Boolean   @default(false)
  createdAt   DateTime  @default(now())
}

model Tag {
  id        String    @id @default(cuid())
  name      String    @unique
  color     String
  icon      String
  createdAt DateTime  @default(now())
  sessions  Session[]
}

model City {
  id          String  @id @default(cuid())
  name        String
  latitude    Float
  longitude   Float
  unlockMiles Int
  departing   Route[] @relation("FromCity")
  arriving    Route[] @relation("ToCity")
}

model Route {
  id            String @id @default(cuid())
  fromCityId    String
  toCityId      String
  requiredMiles Int
  progressMiles Int    @default(0)
  from          City   @relation("FromCity", fields: [fromCityId], references: [id])
  to            City   @relation("ToCity", fields: [toCityId], references: [id])

  @@unique([fromCityId, toCityId])
}

model Achievement {
  id         String    @id @default(cuid())
  key        String    @unique
  unlockedAt DateTime?
  metaJson   String?
}

model Setting {
  key       String @id
  valueJson String
}
